================================================================
GGS GLOBAL CONSULT â€” FIREBASE CONNECTION FOR INDEX.HTML
================================================================
Make ONLY these 3 changes to your existing index.html file.
Your design stays EXACTLY the same. Zero visual changes.
================================================================


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
CHANGE 1 OF 3 â€” ADD FIREBASE SCRIPTS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
Find this line near the top of index.html:
  <script src="https://checkout.flutterwave.com/v3.js"></script>

ADD these 3 lines DIRECTLY AFTER IT:

<script type="importmap">
{
  "imports": {
    "firebase/app": "https://www.gstatic.com/firebasejs/12.9.0/firebase-app.js",
    "firebase/firestore": "https://www.gstatic.com/firebasejs/12.9.0/firebase-firestore.js"
  }
}
</script>
<script type="module" src="firebase-store.js"></script>


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
CHANGE 2 OF 3 â€” REPLACE THE RENDER CALL AT BOTTOM
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
At the very bottom of your index.html, find this line:
  renderCatalog();

REPLACE JUST THAT ONE LINE with:
  // Firebase loads products automatically via firebase-store.js
  // renderCatalog() is now called after Firebase data loads


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
CHANGE 3 OF 3 â€” UPDATE THE FLUTTERWAVE CALLBACK
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
Inside your doPayment() function, find the callback section:
  callback(r) {
    if (r.status === 'successful' || r.status === 'completed') {

ADD this line RIGHT AFTER that if statement opens:
  saveOrderToFirebase(r, first, last, email, phone, state, addr, ref, chosenShip, total, txRef);

So it reads:
  callback(r) {
    if (r.status === 'successful' || r.status === 'completed') {
      saveOrderToFirebase(r, first, last, email, phone, state, addr, ref, chosenShip, total, txRef);
      closeCheckout();
      ... rest of your existing code ...


================================================================
CREATE A NEW FILE: firebase-store.js
================================================================
Create a NEW file called firebase-store.js in the SAME folder
as your index.html. Paste ALL of this into it:

----------------------------------------------------------------

import { initializeApp } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-app.js";
import { getFirestore, collection, doc, getDocs, addDoc, getDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-firestore.js";

const app = initializeApp({
  apiKey: "AIzaSyCGU14FHH82Ja5Bx9ZE3ImlePoyKvZLdYg",
  authDomain: "ggs-global.firebaseapp.com",
  projectId: "ggs-global",
  storageBucket: "ggs-global.firebasestorage.app",
  messagingSenderId: "688407888100",
  appId: "1:688407888100:web:a9f3e068ca9624e3b66cf1"
});
const db = getFirestore(app);

// â”€â”€ LOAD PRODUCTS FROM FIREBASE â”€â”€
async function loadFromFirebase() {
  try {
    const snap = await getDocs(collection(db, 'products'));
    const fbProds = snap.docs.map(d => ({ firestoreId: d.id, ...d.data() }));

    if (fbProds.length === 0) {
      // No products in Firebase yet â€” use defaults and render
      renderCatalog();
      return;
    }

    // Sort by sortOrder
    fbProds.sort((a, b) => (a.sortOrder || 0) - (b.sortOrder || 0));

    // Separate into tech and fashion, only active products
    window.allProducts = {
      tech: fbProds.filter(p => p.category === 'tech' && p.active !== false),
      fashion: fbProds.filter(p => p.category === 'fashion' && p.active !== false)
    };

    // Re-render catalog with live Firebase data
    renderCatalog();

    // Load settings (announcement bar, slots, etc.)
    loadSiteSettings();

  } catch (e) {
    console.warn('Firebase load failed, using defaults:', e.message);
    renderCatalog();
  }
}

// â”€â”€ LOAD SITE SETTINGS â”€â”€
async function loadSiteSettings() {
  try {
    const snap = await getDoc(doc(db, 'settings', 'site-config'));
    if (!snap.exists()) return;
    const s = snap.data();

    // Update announcement bar
    if (s.announcementText) {
      const annBar = document.querySelector('.ann-bar span');
      if (annBar) annBar.textContent = s.announcementText;
    }

    // Update slots
    if (s.urgencySlots) {
      const { total, remaining } = s.urgencySlots;
      const slotsText = document.getElementById('slotsText');
      const slotsFill = document.getElementById('slotsFill');
      if (slotsText) slotsText.textContent = `${total - remaining} of ${total} slots Â· ${remaining} remaining`;
      if (slotsFill) slotsFill.style.width = `${Math.round(((total - remaining) / total) * 100)}%`;
    }

    // Update countdown deadline
    if (s.countdownDeadline?.toDate) {
      window._ggsDeadline = s.countdownDeadline.toDate();
    }

    // Update maintenance mode
    if (s.maintenanceMode === true) {
      document.body.innerHTML = '<div style="display:flex;align-items:center;justify-content:center;min-height:100vh;background:#08090C;color:#F5B945;font-family:sans-serif;text-align:center;padding:40px"><div><div style="font-size:3rem;margin-bottom:20px">ğŸ”§</div><h1 style="font-size:2rem;margin-bottom:12px">Site Under Maintenance</h1><p style="color:#8C8898">We are making some updates. Back shortly!</p></div></div>';
    }

  } catch (e) {
    console.warn('Settings load failed:', e.message);
  }
}

// â”€â”€ SAVE ORDER TO FIREBASE â”€â”€
window.saveOrderToFirebase = async function(r, first, last, email, phone, state, addr, ref, shippingMethod, totalPaid, txRef) {
  try {
    const isRivers = state.toLowerCase().includes('rivers');
    await addDoc(collection(db, 'orders'), {
      txRef: txRef,
      flwId: r.transaction_id || null,
      status: 'paid',
      orderStatus: 'processing',
      customer: { firstName: first, lastName: last, email, phone, state, address: addr },
      items: window.cart?.map(i => ({ id: i.id, name: i.name, icon: i.icon, price: i.price, qty: i.qty, variant: i.variant })) || [],
      totalPaid,
      shippingMethod,
      deliveryFee: isRivers ? 'Free (Port Harcourt)' : 'â‚¦5,000',
      referralCode: ref || 'none',
      createdAt: serverTimestamp(),
      updatedAt: serverTimestamp()
    });
    console.log('âœ… Order saved to Firebase');
  } catch (e) {
    console.warn('Order save failed (non-critical):', e.message);
    // Not critical â€” Flutterwave already processed payment
  }
}

// â”€â”€ START â”€â”€
loadFromFirebase();

----------------------------------------------------------------

================================================================
FIRESTORE SECURITY RULES â€” PASTE INTO FIREBASE CONSOLE
================================================================
Go to: Firebase Console â†’ Firestore Database â†’ Rules tab
Delete everything there and paste this:

rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {

    // Products: anyone can read, only admin can write
    match /products/{id} {
      allow read: if true;
      allow write: if request.auth != null
        && request.auth.token.email == 'ggsglobalconsult@gmail.com';
    }

    // Orders: storefront can create, only admin can read/update
    match /orders/{id} {
      allow create: if true;
      allow read, update, delete: if request.auth != null
        && request.auth.token.email == 'ggsglobalconsult@gmail.com';
    }

    // Settings: anyone can read, only admin can write
    match /settings/{id} {
      allow read: if true;
      allow write: if request.auth != null
        && request.auth.token.email == 'ggsglobalconsult@gmail.com';
    }
  }
}


================================================================
FINAL SETUP STEPS (DO IN ORDER)
================================================================

STEP 1 â€” Create your admin login password
  â€¢ Go to Firebase Console â†’ Authentication â†’ Users tab
  â€¢ Click "Add user"
  â€¢ Email: ggsglobalconsult@gmail.com
  â€¢ Password: Choose a strong password (write it down!)
  â€¢ Click "Add user"

STEP 2 â€” Seed your products into Firebase
  â€¢ Open admin.html in your browser
  â€¢ Log in with ggsglobalconsult@gmail.com + your password
  â€¢ Open browser Developer Tools (F12 on desktop)
  â€¢ Click the "Console" tab
  â€¢ Type: seedProducts()
  â€¢ Press Enter
  â€¢ You will see: "âœ… 14 products seeded!"
  â€¢ Your products are now live in Firebase!

STEP 3 â€” Apply Firestore Security Rules
  â€¢ Go to Firebase Console â†’ Firestore Database â†’ Rules
  â€¢ Paste the rules above
  â€¢ Click "Publish"

STEP 4 â€” Test everything
  â€¢ Open index.html â€” products should load from Firebase
  â€¢ Open admin.html â€” log in, edit a product price, save
  â€¢ Refresh index.html â€” new price should show immediately!

================================================================
YOUR 3 FILES WHEN DONE:
  index.html     (your existing file, 3 small changes made)
  admin.html     (new file â€” your admin dashboard)
  firebase-store.js  (new file â€” Firebase connection bridge)
================================================================
